<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Master List</title>
<style>
  /* Add your CSS styles here */
  .tab { display: none; }
  .tab.active { display: block; }
  .folder-container { display: flex; flex-wrap: wrap; gap: 10px; }
  .folder { border: 1px solid #ccc; padding: 10px; width: 45%; cursor: pointer; text-align: center; }
  .folder-title { font-weight: bold; color: brown; }
  .folder-content { display: none; position: fixed; top: 10%; left: 50%; transform: translateX(-50%); width: 80%; max-height: 70vh; overflow-y: auto; border: 1px solid #ccc; padding: 10px; background-color: #fff; z-index: 100; }
  .folder-content.active { display: block; }
  .product-line { display: flex; align-items: center; margin-bottom: 10px; }
  .product-line input, .product-line select { margin-right: 5px; flex: 1; }
  .checkmark { margin-left: auto; }
  .close-btn { cursor: pointer; color: red; text-align: right; }
  .add-btn { cursor: pointer; color: green; text-align: center; margin-top: 10px; }
</style>
</head>
<body>

<div>
  <button onclick="showTab('master')">Master List</button>
  <button onclick="showTab('shopping')">Shopping List</button>
</div>

<div id="master" class="tab active">
  <div class="folder-container">
    <div class="folder" id="folder1">
      <div class="folder-title">Produce</div>
    </div>
    <!-- Additional folders can be added here -->
    <button onclick="addFolder()">+</button>
  </div>
</div>

<div id="shopping" class="tab">
  <div id="shopping-list"></div>
</div>

<script>
  function showTab(tabName) {
    document.querySelectorAll('.tab').forEach(tab => {
      tab.classList.remove('active');
    });
    document.getElementById(tabName).classList.add('active');
  }

  function addFolder() {
    const folderContainer = document.querySelector('.folder-container');
    const folderCount = document.querySelectorAll('.folder').length + 1;
    const newFolder = document.createElement('div');
    newFolder.className = 'folder';
    newFolder.id = 'folder' + folderCount;
    newFolder.innerHTML = `<div class="folder-title">Folder ${folderCount}</div>`;
    folderContainer.insertBefore(newFolder, folderContainer.querySelector('button'));
    attachFolderEvents(newFolder);
  }

  function openFolder(folder) {
    const content = document.createElement('div');
    content.className = 'folder-content';
    content.innerHTML = `
      <div class="close-btn" onclick="closeFolder(this)">x</div>
      <div class="product-line">
        <input type="text" placeholder="Product Name" maxlength="15">
        <input type="number" placeholder="Qty" min="1">
        <select>
          <option value="oz">oz</option>
          <option value="lb">lb</option>
          <option value="bag">bag</option>
          <option value="liter">liter</option>
        </select>
        <input type="checkbox" class="add-to-shopping">
      </div>
      <div class="add-btn" onclick="addProduct(this)">Add Product</div>
    `;
    folder.appendChild(content);
    content.classList.add('active');
    attachProductEvents(content);
  }

  function closeFolder(button) {
    const content = button.parentNode;
    content.classList.remove('active');
    setTimeout(() => content.remove(), 300);  // Delay to allow animation (if any)
  }

  function addProduct(button) {
    const productLine = document.createElement('div');
    productLine.className = 'product-line';
    productLine.innerHTML = `
      <input type="text" placeholder="Product Name" maxlength="15">
      <input type="number" placeholder="Qty" min="1">
      <select>
        <option value="oz">oz</option>
        <option value="lb">lb</option>
        <option value="bag">bag</option>
        <option value="liter">liter</option>
      </select>
      <input type="checkbox" class="add-to-shopping">
    `;
    button.parentNode.insertBefore(productLine, button);
    attachProductEvents(productLine);
  }

  function attachFolderEvents(folder) {
    folder.addEventListener('click', () => {
      openFolder(folder);
    });
  }

  function attachProductEvents(productLine) {
    productLine.querySelector('.add-to-shopping').addEventListener('change', (event) => {
      if (event.target.checked) {
        addToShoppingList(event.target);
      } else {
        removeFromShoppingList(event.target);
      }
    });
  }

  function addToShoppingList(checkbox) {
    const productLine = checkbox.parentNode;
    const productName = productLine.querySelector('input[type="text"]').value;
    const quantity = productLine.querySelector('input[type="number"]').value;
    const unit = productLine.querySelector('select').value;
    const shoppingList = document.getElementById('shopping-list');

    const shoppingItem = document.createElement('div');
    shoppingItem.className = 'shopping-item';
    shoppingItem.innerHTML = `
      <span>${productName} - ${quantity} ${unit}</span>
      <input type="number" value="${quantity}" min="1">
      <span class="close-btn" onclick="removeShoppingItem(this)">x</span>
    `;
    shoppingList.appendChild(shoppingItem);
  }

  function removeFromShoppingList(checkbox) {
    const productLine = checkbox.parentNode;
    const productName = productLine.querySelector('input[type="text"]').value;
    const shoppingList = document.getElementById('shopping-list');
    const shoppingItems = shoppingList.querySelectorAll('.shopping-item');

    shoppingItems.forEach(item => {
      if (item.querySelector('span').innerText.includes(productName)) {
        item.remove();
      }
    });
  }

  function removeShoppingItem(button) {
    button.parentNode.remove();
  }

  // Attach events to existing folders
  document.querySelectorAll('.folder').forEach(folder => {
    attachFolderEvents(folder);
  });
</script>

</body>
</html>